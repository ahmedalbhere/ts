<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TS - Trending Shorts</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.css">

<style>
    :root {
        --bg: #000000;
        --text: #ffffff;
        --card: #121212;
        --accent: #ff0050;
        --tiktok: #ff0050;
        --instagram: #E4405F;
        --youtube: #FF0000;
        --shadow: rgba(0, 0, 0, 0.8);
    }

    body.light {
        --bg: #f6f6f6;
        --text: #111;
        --card: #ffffff;
        --accent: #ff0050;
        --shadow: rgba(0, 0, 0, 0.2);
    }

    * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
    }

    html, body {
        height: 100%;
        overflow: hidden;
    }

    body {
        background: var(--bg);
        color: var(--text);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        margin: 0;
        padding: 0;
        transition: 0.3s;
        touch-action: pan-y;
    }

    /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‡ÙŠØ¯Ø± */
    header {
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        height: 50px;
    }

    .logo-container {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .logo {
        font-size: 24px;
        font-weight: bold;
        color: var(--accent);
        letter-spacing: 0.5px;
    }

    .app-name {
        font-size: 16px;
        font-weight: 600;
    }

    .controls {
        display: flex;
        gap: 8px;
        align-items: center;
    }

    .icon-btn {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        font-size: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: 0.2s;
    }

    .icon-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    #videoContainer {
        height: 100vh;
        width: 100%;
        position: relative;
        overflow: hidden;
        padding-top: 50px; /* ØªØ¹ÙˆÙŠØ¶ Ø§Ù„Ù‡ÙŠØ¯Ø± */
    }

    .swiper {
        width: 100%;
        height: 100%;
    }

    .swiper-slide {
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
    }

    .video-card {
        width: 100%;
        height: 100%;
        position: relative;
        overflow: hidden;
    }

    .video-player {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #000;
    }

    iframe.video-frame {
        width: 100%;
        height: 100%;
        border: none;
        position: absolute;
        top: 0;
        left: 0;
    }

    .video-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 20px;
        background: linear-gradient(transparent, rgba(0,0,0,0.8));
        color: white;
        z-index: 10;
    }

    .video-title {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 8px;
        line-height: 1.3;
    }

    .video-meta {
        display: flex;
        align-items: center;
        gap: 15px;
        font-size: 14px;
        opacity: 0.9;
    }

    .platform-badge {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
    }

    .platform-tiktok {
        background: var(--tiktok);
    }

    .platform-instagram {
        background: var(--instagram);
    }

    .platform-youtube {
        background: var(--youtube);
    }

    .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 2000;
        gap: 20px;
    }

    .loader {
        width: 50px;
        height: 50px;
        border: 3px solid rgba(255, 0, 80, 0.2);
        border-top: 3px solid var(--accent);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .swipe-hint {
        position: fixed;
        bottom: 100px;
        left: 0;
        right: 0;
        text-align: center;
        color: rgba(255, 255, 255, 0.7);
        font-size: 14px;
        z-index: 100;
        animation: fadeInOut 3s infinite;
        pointer-events: none;
    }

    @keyframes fadeInOut {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 1; }
    }

    .video-actions {
        position: absolute;
        right: 15px;
        bottom: 100px;
        display: flex;
        flex-direction: column;
        gap: 20px;
        z-index: 10;
    }

    .action-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 5px;
        color: white;
        background: none;
        border: none;
        cursor: pointer;
        font-size: 12px;
    }

    .action-icon {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(5px);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        transition: 0.2s;
    }

    .action-btn:hover .action-icon {
        transform: scale(1.1);
        background: rgba(255, 0, 80, 0.3);
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
    .progress-container {
        position: fixed;
        top: 50px;
        left: 0;
        right: 0;
        height: 3px;
        background: rgba(255, 255, 255, 0.1);
        z-index: 1000;
    }

    .progress-bar {
        height: 100%;
        background: var(--accent);
        width: 0%;
        transition: width 0.3s;
    }

    .error-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        text-align: center;
        z-index: 2000;
        gap: 20px;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù‡ÙˆØ§ØªÙ */
    @media (max-width: 768px) {
        header {
            padding: 10px;
        }
        
        .app-name {
            display: none;
        }
        
        .video-overlay {
            padding: 15px;
        }
        
        .video-title {
            font-size: 14px;
        }
        
        .video-meta {
            font-size: 12px;
        }
        
        .video-actions {
            right: 10px;
            bottom: 80px;
        }
        
        .action-icon {
            width: 40px;
            height: 40px;
            font-size: 18px;
        }
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    .swiper-pagination {
        position: fixed !important;
        top: 60px;
        right: 15px;
        width: auto !important;
        left: auto !important;
        bottom: auto !important;
        z-index: 1000;
    }

    .swiper-pagination-bullet {
        background: rgba(255, 255, 255, 0.5);
        opacity: 1;
        width: 6px;
        height: 6px;
    }

    .swiper-pagination-bullet-active {
        background: var(--accent);
        width: 8px;
        height: 8px;
    }
</style>
</head>

<body>
<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div class="loading-screen" id="loadingScreen">
    <div class="loader"></div>
    <div>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø£Ø­Ø¯Ø« Ø§Ù„Ø´ÙˆØ±ØªØ§Øª...</div>
</div>

<!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
<div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
</div>

<!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
<header>
    <div class="logo-container">
        <div class="logo">TS</div>
        <div class="app-name">Trending Shorts</div>
    </div>
    
    <div class="controls">
        <button class="icon-btn" onclick="refreshVideos()" id="refreshBtn">
            <i class="fas fa-sync-alt"></i>
        </button>
        <button class="icon-btn" onclick="toggleTheme()">
            <i class="fas fa-moon"></i>
        </button>
        <button class="icon-btn" onclick="toggleMute()" id="muteBtn">
            <i class="fas fa-volume-up"></i>
        </button>
    </div>
</header>

<!-- ØªÙ„Ù…ÙŠØ­Ø© Ø§Ù„Ø³Ø­Ø¨ -->
<div class="swipe-hint" id="swipeHint">
    <i class="fas fa-arrow-up"></i> Ø§Ø³Ø­Ø¨ Ù„Ø£Ø¹Ù„Ù‰/Ø£Ø³ÙÙ„ Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
</div>

<!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="videoContainer">
    <div class="swiper">
        <div class="swiper-wrapper" id="videoSwiper">
            <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
        </div>
    </div>
</div>

<!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
<div class="video-actions">
    <button class="action-btn" onclick="likeVideo()">
        <div class="action-icon">
            <i class="far fa-heart"></i>
        </div>
        <span>Ø¥Ø¹Ø¬Ø§Ø¨</span>
    </button>
    
    <button class="action-btn" onclick="shareVideo()">
        <div class="action-icon">
            <i class="fas fa-share"></i>
        </div>
        <span>Ù…Ø´Ø§Ø±ÙƒØ©</span>
    </button>
    
    <button class="action-btn" onclick="downloadVideo()">
        <div class="action-icon">
            <i class="fas fa-download"></i>
        </div>
        <span>ØªØ­Ù…ÙŠÙ„</span>
    </button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/11.0.5/swiper-bundle.min.js"></script>
<script>
// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
let swiper = null;
let currentVideoIndex = 0;
let videos = [];
let isMuted = true;
let isLoading = false;
const API_KEYS = {
    tiktok: 'YOUR_TIKTOK_API_KEY', // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…ÙØªØ§Ø­ TikTok API Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
    instagram: 'YOUR_INSTAGRAM_API_KEY' // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…ÙØªØ§Ø­ Instagram API Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
};

// Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª (Ø³ØªØ³ØªØ¨Ø¯Ù„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©)
const MOCK_VIDEOS = [
    {
        id: 1,
        title: "Ø´ÙˆØ±Øª ÙƒÙˆÙ…ÙŠØ¯ÙŠ Ù…Ø¶Ø­Ùƒ Ø¬Ø¯Ø§Ù‹ ğŸ˜‚",
        platform: "tiktok",
        url: "https://www.tiktok.com/embed/v2/7321234567890123456",
        views: "2.5M",
        likes: "350K"
    },
    {
        id: 2,
        title: "ØªØ­Ø¯ÙŠ Ø±Ù‚Øµ ØªØ±Ù†Ø¯ Ø¹Ù„Ù‰ ØªÙŠÙƒ ØªÙˆÙƒ ğŸ’ƒ",
        platform: "tiktok",
        url: "https://www.tiktok.com/embed/v2/7329876543210987654",
        views: "5.1M",
        likes: "890K"
    },
    {
        id: 3,
        title: "Ù…Ù‡Ø§Ø±Ø§Øª Ù„Ø§ ØªØµØ¯Ù‚ Ø¹Ù„Ù‰ Reels ğŸ¤¯",
        platform: "instagram",
        url: "https://www.instagram.com/reel/C5jK8XqgP9L/embed",
        views: "1.8M",
        likes: "210K"
    },
    {
        id: 4,
        title: "ÙŠÙˆØªÙŠÙˆØ¨ Ø´ÙˆØ±ØªØ² - ÙÙƒØ§Ù‡Ø© Ø³Ø±ÙŠØ¹Ø© ğŸ¬",
        platform: "youtube",
        url: "https://www.youtube.com/embed/dQw4w9WgXcQ",
        views: "3.4M",
        likes: "450K"
    }
];

// ØªÙ‡ÙŠØ¦Ø© Swiper
function initSwiper() {
    swiper = new Swiper('.swiper', {
        direction: 'vertical',
        slidesPerView: 1,
        spaceBetween: 0,
        mousewheel: true,
        touchRatio: 1,
        speed: 300,
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        on: {
            slideChange: function() {
                currentVideoIndex = this.activeIndex;
                updateProgress();
                playCurrentVideo();
                hideSwipeHint();
            }
        }
    });
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ØªØ¹Ø¯Ø¯Ø©
async function loadVideos() {
    if (isLoading) return;
    
    isLoading = true;
    showLoading(true);
    
    try {
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©
        let fetchedVideos = [];
        
        // 1. Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ù…Ù† TikTok API
        try {
            const tiktokVideos = await fetchTikTokTrending();
            fetchedVideos = fetchedVideos.concat(tiktokVideos);
        } catch (error) {
            console.warn('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª TikTok:', error);
        }
        
        // 2. Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ù…Ù† Instagram API
        try {
            const instagramVideos = await fetchInstagramTrending();
            fetchedVideos = fetchedVideos.concat(instagramVideos);
        } catch (error) {
            console.warn('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Instagram:', error);
        }
        
        // 3. Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ù…Ù† YouTube Shorts
        try {
            const youtubeVideos = await fetchYouTubeShorts();
            fetchedVideos = fetchedVideos.concat(youtubeVideos);
        } catch (error) {
            console.warn('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª YouTube:', error);
        }
        
        // Ø¥Ø°Ø§ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø¬Ù„Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§ØªØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
        if (fetchedVideos.length === 0) {
            console.log('Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
            videos = MOCK_VIDEOS;
        } else {
            videos = fetchedVideos.slice(0, 20); // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
        renderVideos();
        
    } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª:', error);
        showError('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
        videos = MOCK_VIDEOS;
        renderVideos();
    } finally {
        isLoading = false;
        showLoading(false);
    }
}

// Ù…Ø­Ø§ÙƒØ§Ø© API Ù„Ù€ TikTok
async function fetchTikTokTrending() {
    // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø§Ø³ØªØ®Ø¯Ù… TikTok API
    // Ù‡Ø°Ù‡ Ù…Ø¬Ø±Ø¯ Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    return [
        {
            id: 'tiktok_1',
            title: "ØªØ±Ù†Ø¯ ØªÙŠÙƒ ØªÙˆÙƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯ 2024 ğŸš€",
            platform: "tiktok",
            url: "https://www.tiktok.com/@user/video/7321234567890123456",
            embedUrl: "https://www.tiktok.com/embed/v2/7321234567890123456",
            views: "3.2M",
            likes: "500K"
        },
        {
            id: 'tiktok_2',
            title: "ØªØ­Ø¯ÙŠ Ø§Ù„Ø±Ù‚Øµ Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ ğŸ’ƒ",
            platform: "tiktok",
            url: "https://www.tiktok.com/@user/video/7329876543210987654",
            embedUrl: "https://www.tiktok.com/embed/v2/7329876543210987654",
            views: "4.5M",
            likes: "720K"
        }
    ];
}

// Ù…Ø­Ø§ÙƒØ§Ø© API Ù„Ù€ Instagram
async function fetchInstagramTrending() {
    // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø§Ø³ØªØ®Ø¯Ù… Instagram Graph API
    return [
        {
            id: 'instagram_1',
            title: "Reels Ù…Ø¶Ø­ÙƒØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù… ğŸ˜‚",
            platform: "instagram",
            url: "https://www.instagram.com/reel/C5jK8XqgP9L/",
            embedUrl: "https://www.instagram.com/reel/C5jK8XqgP9L/embed",
            views: "1.2M",
            likes: "180K"
        },
        {
            id: 'instagram_2',
            title: "ØªØ­Ø¯ÙŠ Ø§Ù„Ù€ 24 Ø³Ø§Ø¹Ø© Ø¹Ù„Ù‰ Reels â°",
            platform: "instagram",
            url: "https://www.instagram.com/reel/C5kL9YrhQ2M/",
            embedUrl: "https://www.instagram.com/reel/C5kL9YrhQ2M/embed",
            views: "2.1M",
            likes: "310K"
        }
    ];
}

// Ø¬Ù„Ø¨ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª YouTube Shorts
async function fetchYouTubeShorts() {
    try {
        const response = await fetch(
            `https://api.allorigins.win/raw?url=${encodeURIComponent(
                'https://www.youtube.com/feeds/videos.xml?playlist_id=PLrEnWoR732-BHrPp_Pm8_VleD68f9s14-'
            )}`
        );
        const xml = await response.text();
        const parser = new DOMParser();
        const data = parser.parseFromString(xml, "text/xml");
        const entries = data.getElementsByTagName("entry");
        
        const youtubeVideos = [];
        for (let i = 0; i < Math.min(5, entries.length); i++) {
            const title = entries[i].getElementsByTagName("title")[0]?.textContent || "ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨";
            const videoId = entries[i].getElementsByTagName("yt:videoId")[0]?.textContent;
            
            if (videoId) {
                youtubeVideos.push({
                    id: `youtube_${i}`,
                    title: title,
                    platform: "youtube",
                    url: `https://www.youtube.com/shorts/${videoId}`,
                    embedUrl: `https://www.youtube.com/embed/${videoId}`,
                    views: `${Math.floor(Math.random() * 5) + 1}M`,
                    likes: `${Math.floor(Math.random() * 500) + 100}K`
                });
            }
        }
        return youtubeVideos;
    } catch (error) {
        throw error;
    }
}

// Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ÙÙŠ Swiper
function renderVideos() {
    const swiperWrapper = document.getElementById('videoSwiper');
    swiperWrapper.innerHTML = '';
    
    videos.forEach((video, index) => {
        const slide = document.createElement('div');
        slide.className = 'swiper-slide';
        
        let platformClass = '';
        switch(video.platform) {
            case 'tiktok': platformClass = 'platform-tiktok'; break;
            case 'instagram': platformClass = 'platform-instagram'; break;
            case 'youtube': platformClass = 'platform-youtube'; break;
        }
        
        slide.innerHTML = `
            <div class="video-card">
                <div class="video-player" id="videoPlayer_${index}">
                    <iframe 
                        class="video-frame"
                        src="${video.embedUrl}?autoplay=0&mute=1&controls=0&modestbranding=1&rel=0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen
                        loading="lazy"
                        title="${video.title}"
                    ></iframe>
                </div>
                
                <div class="video-overlay">
                    <div class="video-title">${video.title}</div>
                    <div class="video-meta">
                        <span class="platform-badge ${platformClass}">
                            <i class="fab fa-${video.platform}"></i>
                            ${video.platform.charAt(0).toUpperCase() + video.platform.slice(1)}
                        </span>
                        <span><i class="far fa-eye"></i> ${video.views}</span>
                        <span><i class="far fa-heart"></i> ${video.likes}</span>
                    </div>
                </div>
            </div>
        `;
        
        swiperWrapper.appendChild(slide);
    });
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Swiper
    if (swiper) {
        swiper.destroy();
    }
    initSwiper();
    playCurrentVideo();
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø­Ø§Ù„ÙŠ
function playCurrentVideo() {
    // Ø¥ÙŠÙ‚Ø§Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
    document.querySelectorAll('iframe').forEach(iframe => {
        iframe.contentWindow?.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
    });
    
    // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø­Ø§Ù„ÙŠ
    const currentIframe = document.querySelector(`#videoPlayer_${currentVideoIndex} iframe`);
    if (currentIframe) {
        const src = currentIframe.src;
        if (isMuted) {
            currentIframe.src = src.replace(/mute=\d/, 'mute=1');
        } else {
            currentIframe.src = src.replace(/mute=\d/, 'mute=0');
        }
        
        // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        setTimeout(() => {
            currentIframe.contentWindow?.postMessage('{"event":"command","func":"playVideo","args":""}', '*');
        }, 300);
    }
}

// ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
function updateProgress() {
    const progress = ((currentVideoIndex + 1) / videos.length) * 100;
    document.getElementById('progressBar').style.width = `${progress}%`;
}

// ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹
function toggleTheme() {
    document.body.classList.toggle('light');
    const themeIcon = document.querySelector('[onclick="toggleTheme()"] i');
    if (document.body.classList.contains('light')) {
        themeIcon.className = 'fas fa-sun';
    } else {
        themeIcon.className = 'fas fa-moon';
    }
    localStorage.setItem('theme', document.body.classList.contains('light') ? 'light' : 'dark');
}

// ØªØ¨Ø¯ÙŠÙ„ ÙƒØªÙ… Ø§Ù„ØµÙˆØª
function toggleMute() {
    isMuted = !isMuted;
    const muteBtn = document.getElementById('muteBtn');
    muteBtn.innerHTML = isMuted ? '<i class="fas fa-volume-mute"></i>' : '<i class="fas fa-volume-up"></i>';
    playCurrentVideo();
}

// Ø¥Ø®ÙØ§Ø¡ ØªÙ„Ù…ÙŠØ­Ø© Ø§Ù„Ø³Ø­Ø¨
function hideSwipeHint() {
    const hint = document.getElementById('swipeHint');
    hint.style.opacity = '0';
    setTimeout(() => {
        hint.style.display = 'none';
    }, 300);
}

// Ø¹Ø±Ø¶/Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
function showLoading(show) {
    const loadingScreen = document.getElementById('loadingScreen');
    if (show) {
        loadingScreen.style.display = 'flex';
    } else {
        loadingScreen.style.opacity = '0';
        setTimeout(() => {
            loadingScreen.style.display = 'none';
        }, 300);
    }
}

// Ø¹Ø±Ø¶ Ø®Ø·Ø£
function showError(message) {
    const errorHTML = `
        <div class="error-screen">
            <i class="fas fa-exclamation-triangle" style="font-size: 48px; color: var(--accent);"></i>
            <h3>âš ï¸ ${message}</h3>
            <button class="icon-btn" onclick="location.reload()" style="margin-top: 20px;">
                <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„
            </button>
        </div>
    `;
    document.body.insertAdjacentHTML('beforeend', errorHTML);
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
function refreshVideos() {
    if (isLoading) return;
    
    const refreshBtn = document.getElementById('refreshBtn');
    refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
    refreshBtn.disabled = true;
    
    setTimeout(() => {
        loadVideos();
        refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i>';
        refreshBtn.disabled = false;
    }, 500);
}

// ÙˆØ¸Ø§Ø¦Ù Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
function likeVideo() {
    const likeBtn = document.querySelector('.action-btn:nth-child(1) i');
    likeBtn.className = 'fas fa-heart';
    likeBtn.style.color = '#ff0050';
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø©
    showToast('ØªÙ…Øª Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨ Ø¨Ø§Ù„ÙÙŠØ¯ÙŠÙˆ â¤ï¸');
}

function shareVideo() {
    if (navigator.share) {
        navigator.share({
            title: videos[currentVideoIndex]?.title || 'Ø´ÙˆØ±Øª ØªØ±Ù†Ø¯',
            url: videos[currentVideoIndex]?.url || window.location.href
        });
    } else {
        navigator.clipboard.writeText(videos[currentVideoIndex]?.url || window.location.href);
        showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ğŸ“‹');
    }
}

function downloadVideo() {
    showToast('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ... â¬‡ï¸');
    // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ØªØ¶ÙŠÙ Ù…Ù†Ø·Ù‚ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§
}

function showToast(message) {
    const toast = document.createElement('div');
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--accent);
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        z-index: 10000;
        font-size: 14px;
        animation: fadeInOut 2s ease-in-out;
    `;
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 2000);
}

// Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', () => {
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
        document.body.classList.add('light');
        document.querySelector('[onclick="toggleTheme()"] i').className = 'fas fa-sun';
    }
    
    // ØªÙ‡ÙŠØ¦Ø© Swiper
    initSwiper();
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
    loadVideos();
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
    setTimeout(hideSwipeHint, 5000);
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
    setInterval(() => {
        if (!document.hidden && videos.length > 0) {
            refreshVideos();
        }
    }, 5 * 60 * 1000);
});

// Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØªØºÙŠÙŠØ± Ø±Ø¤ÙŠØ© Ø§Ù„ØµÙØ­Ø©
document.addEventListener('visibilitychange', () => {
    if (document.hidden) {
        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù†Ø¯ ØªØ±Ùƒ Ø§Ù„ØµÙØ­Ø©
        document.querySelectorAll('iframe').forEach(iframe => {
            iframe.contentWindow?.postMessage('{"event":"command","func":"pauseVideo","args":""}', '*');
        });
    } else {
        // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù†Ø¯ Ø§Ù„Ø¹ÙˆØ¯Ø©
        playCurrentVideo();
    }
});
</script>

</body>
    </html>
